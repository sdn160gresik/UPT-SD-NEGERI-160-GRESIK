<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Game Perkalian 2‚Äì9 (Input Angka)</title>
  <style>
    :root {
      --bg: #2e6e61;
      --panel: #3c816f;
      --panel-dark: #2a5c4f;
      --text: #ffffff;
      --right: #2ecc71;
      --wrong: #e74c3c;
      --outline: rgba(255,255,255,.25);
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;display:grid;place-items:center;
      background:linear-gradient(160deg,var(--bg),#24594d 60%);
      font-family:"Poppins",system-ui,sans-serif;color:var(--text);
    }
    .app{
      width:min(880px,96vw);background:var(--panel);border-radius:22px;
      box-shadow:0 20px 50px rgba(0,0,0,.25),inset 0 0 0 1px var(--outline);
      padding:clamp(18px,3.2vw,28px);position:relative;z-index:2;
    }

    /* === Timer melayang di depan === */
    .floating-timer{
      position:fixed;top:20px;left:50%;transform:translateX(-50%);
      background:rgba(255,255,255,0.15);
      border:3px solid rgba(255,255,255,0.3);
      padding:10px 30px;border-radius:999px;
      font-size:clamp(28px,5vw,46px);font-weight:800;
      color:#fffb91;text-shadow:0 0 10px rgba(0,0,0,0.5);
      backdrop-filter:blur(8px);
      transition:transform .2s ease,color .3s ease;
      z-index:9999;
    }
    .floating-timer.low{
      color:#ff5757;
      transform:translateX(-50%) scale(1.1);
      animation:pulse 0.6s infinite alternate;
    }
    @keyframes pulse{
      from{text-shadow:0 0 10px rgba(255,0,0,0.4);}
      to{text-shadow:0 0 20px rgba(255,0,0,0.8);}
    }

    /* === Kotak mengambang untuk pesan akhir === */
    .floating-box {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      background: rgba(255,255,255,0.95);
      color: #2a5c4f;
      padding: 30px 50px;
      border-radius: 20px;
      font-size: 28px;
      font-weight: 700;
      box-shadow: 0 12px 40px rgba(0,0,0,0.3);
      text-align: center;
      opacity: 0;
      pointer-events: none;
      transition: all 0.5s ease;
      z-index: 99999;
    }
    .floating-box.show {
      opacity: 1;
      pointer-events: auto;
      transform: translate(-50%, -50%) scale(1);
    }
    .floating-box.good {color:#2ecc71;}
    .floating-box.medium {color:#f1c40f;}
    .floating-box.bad {color:#e74c3c;}

    header{display:flex;justify-content:space-between;flex-wrap:wrap;gap:12px;margin-bottom:14px;}
    .brand{font-weight:800;}
    .pill{
      background:var(--panel-dark);border:1px solid var(--outline);
      padding:8px 12px;border-radius:999px;font-size:14px;
    }
    .screen{display:none}.screen.active{display:block}
    .btn{background:#58b68c;border:none;color:#0f2e27;font-weight:700;
      padding:12px 18px;border-radius:14px;cursor:pointer;
      box-shadow:0 8px 18px rgba(0,0,0,.18);}
    .btn.secondary{background:#6aa89a;color:#09322a}

    .question{
      display:grid;place-items:center;background:#2b6d5f;border-radius:18px;
      border:1px solid var(--outline);margin:12px 0 16px;padding:18px;
      min-height:120px;text-align:center;
    }
    .expr{font-size:clamp(42px,9vw,86px);font-weight:900;letter-spacing:1px;}
    .input-area{display:flex;justify-content:center;align-items:center;gap:10px;margin-top:10px;}
    input[type=number]{font-size:28px;padding:8px 12px;width:140px;text-align:center;border-radius:12px;border:none;}
    .feedback{font-size:22px;margin-top:10px;height:28px;}
    .feedback.correct{color:var(--right)}.feedback.wrong{color:var(--wrong)}
    .progress{height:10px;background:#2b6d5f;border-radius:999px;overflow:hidden;margin-bottom:8px;}
    .bar{height:100%;width:0%;background:#84f0b8;transition:width .3s ease;}
    .end{text-align:center;}
    .big-score{font-size:clamp(36px,8vw,70px);font-weight:900;}
    .nilai-hijau{color:#2ecc71}.nilai-kuning{color:#f1c40f}.nilai-merah{color:#e74c3c}

    .option-grid {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      margin: 20px 0;
    }
    .option-box {
      background: #2b6d5f;
      border: 2px solid var(--outline);
      border-radius: 18px;
      padding: 18px;
      flex: 1;
      min-width: 220px;
      text-align: center;
      font-size: 18px;
    }
    .option-box label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .option-box select {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: none;
      font-size: 16px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="floating-timer" id="floatingTimer">‚è±Ô∏è 10</div>
  <div class="floating-box" id="floatingBox"></div>

  <div class="app">
    <header>
      <div class="brand">üî¢ Perkalian 2‚Äì9</div>
      <div class="stats">
        <div class="pill">Soal: <strong id="pNo">0</strong>/<span id="pTotal">0</span></div>
        <div class="pill">Skor: <strong id="pScore">0</strong></div>
      </div>
    </header>
    <div class="progress"><div class="bar" id="bar"></div></div>

    <section class="screen start active" id="startScreen">
      <h1>Siap latihan cepat? üéØ</h1>
      <div class="option-grid">
        <div class="option-box">
          <label for="jumlah">Jumlah Soal</label>
          <select id="jumlah">
            <option value="5">5</option>
            <option value="10" selected>10</option>
            <option value="20">20</option>
            <option value="30">30</option>
          </select>
        </div>
        <div class="option-box">
          <label for="mode">Mode</label>
          <select id="mode">
            <option value="campur" selected>Campur (acak)</option>
            <option value="2">Perkalian 2</option>
            <option value="3">Perkalian 3</option>
            <option value="4">Perkalian 4</option>
            <option value="5">Perkalian 5</option>
            <option value="6">Perkalian 6</option>
            <option value="7">Perkalian 7</option>
            <option value="8">Perkalian 8</option>
            <option value="9">Perkalian 9</option>
          </select>
        </div>
      </div>
      <button class="btn" id="btnStart">Mulai ‚ñ∂</button>
    </section>

    <section class="screen" id="gameScreen">
      <div class="question"><div class="expr" id="expr"></div></div>
      <div class="input-area">
        <input type="number" id="answerInput" placeholder="Jawab..." />
        <button class="btn" id="btnCheck">Periksa ‚úÖ</button>
      </div>
      <div class="feedback" id="feedback"></div>
      <div class="controls" style="text-align:center;margin-top:10px;">
        <button class="btn secondary" id="btnSkip">Lewati ‚è≠</button>
      </div>
    </section>

    <section class="screen end" id="endScreen">
      <div class="big-score" id="finalScore"></div>
      <div class="msg" id="finalMsg"></div>
      <button class="btn" id="btnRestart">Main Lagi üîÅ</button>
    </section>
  </div>

  <script>
    const TIME_LIMIT = 10;
    const floatingTimer = document.getElementById('floatingTimer');
    const floatingBox = document.getElementById('floatingBox');
    let timeLeft, timerInterval;
    let pairs=[], idx=0, score=0, skipped=[], total=0;

    const startScreen=document.getElementById('startScreen'),
          gameScreen=document.getElementById('gameScreen'),
          endScreen=document.getElementById('endScreen'),
          expr=document.getElementById('expr'),
          answer=document.getElementById('answerInput'),
          feedback=document.getElementById('feedback'),
          pNo=document.getElementById('pNo'),
          pTotal=document.getElementById('pTotal'),
          pScore=document.getElementById('pScore'),
          bar=document.getElementById('bar'),
          finalScore=document.getElementById('finalScore'),
          finalMsg=document.getElementById('finalMsg');

    function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

    function startGame(){
      const n=parseInt(document.getElementById('jumlah').value);
      const mode=document.getElementById('mode').value;
      let all=[];
      if(mode==='campur'){for(let a=2;a<=9;a++){for(let b=2;b<=9;b++){all.push({a,b});}}}
      else{const m=parseInt(mode);for(let b=2;b<=9;b++){all.push({a:m,b});}}
      shuffle(all);
      pairs=all.slice(0,n);
      idx=0;score=0;skipped=[];total=pairs.length;
      pNo.textContent=0;pTotal.textContent=total;pScore.textContent=0;
      startScreen.classList.remove('active');endScreen.classList.remove('active');
      gameScreen.classList.add('active');
      renderQuestion();
    }

    function renderQuestion(){
      const {a,b}=pairs[idx];
      expr.textContent=`${a} √ó ${b}`;
      answer.value='';feedback.textContent='';
      pNo.textContent=idx+1;
      bar.style.width=(idx/total*100)+'%';
      startTimer();
      answer.focus();
    }

    function startTimer(){
      clearInterval(timerInterval);
      timeLeft=TIME_LIMIT;
      updateTimer();
      timerInterval=setInterval(()=>{
        timeLeft--;
        updateTimer();
        if(timeLeft<=0){clearInterval(timerInterval);skip();}
      },1000);
    }
    function updateTimer(){
      floatingTimer.textContent=`‚è±Ô∏è ${timeLeft}`;
      floatingTimer.classList.toggle("low", timeLeft<=3);
    }

    function check(){
      clearInterval(timerInterval);
      const {a,b}=pairs[idx];
      const correct=a*b;
      const val=parseInt(answer.value);
      if(val===correct){
        score++;feedback.textContent="‚úÖ Benar!";
        feedback.className="feedback correct";
      }else{
        feedback.textContent=`‚ùå Salah! Jawaban: ${correct}`;
        feedback.className="feedback wrong";
      }
      pScore.textContent=score;
      setTimeout(next,700);
    }

    function skip(){
      skipped.push(pairs[idx]);
      next();
    }

    function next(){
      idx++;
      if(idx>=pairs.length){
        if(skipped.length>0){pairs=skipped;skipped=[];idx=0;renderQuestion();}
        else endGame();
      }else renderQuestion();
    }

    function endGame(){
      gameScreen.classList.remove('active');
      endScreen.classList.add('active');
      const pct=Math.round(score/total*100); // nilai bulat
      finalScore.textContent=`${pct}`;
      finalScore.className="big-score";
      let msgClass="";
      if(pct>=75){finalScore.classList.add("nilai-hijau");msgClass="good";}
      else if(pct>=50){finalScore.classList.add("nilai-kuning");msgClass="medium";}
      else{finalScore.classList.add("nilai-merah");msgClass="bad";}
      const msg=pct>=90?"Super sekali! üåü":pct>=75?"Hebat! üí™":pct>=50?"Bagus! üôÇ":"Semangat! üöÄ";
      finalMsg.textContent=msg;
      showFloatingBox(`${pct} - ${msg}`, msgClass);
    }

    function showFloatingBox(text, cls){
      floatingBox.textContent=text;
      floatingBox.className=`floating-box show ${cls}`;
      setTimeout(()=>floatingBox.classList.remove('show'),3000);
    }

    document.getElementById('btnStart').onclick=startGame;
    document.getElementById('btnCheck').onclick=check;
    document.getElementById('btnSkip').onclick=skip;
    document.getElementById('btnRestart').onclick=()=>{
      endScreen.classList.remove('active');
      startScreen.classList.add('active');
    };
  </script>
</body>
</html>
