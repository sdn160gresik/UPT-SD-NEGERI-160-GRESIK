<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Kuis Seru Petualangan</title>
<style>
.kotak-soal {
    background-color: white;
    border: 2px solid #add8e6;
    border-radius: 10px;
    padding: 15px 20px;
    margin-bottom: 15px;
    max-width: 600px;
    width: 100%;
}
body {
    font-family: 'Arial', sans-serif;
    padding: 20px;
    background-image: url('https://i.imgur.com/IFKQPGS.png');
    background-size: cover;
    background-position: center;
}
.container { max-width: 100%; margin: 0 auto; padding: 20px; border-radius: 10px;
    display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; }
.nav { display: flex; gap: 20px; justify-content: center; margin-bottom: 20px; }
.nav a { text-decoration: none; color: #2c3e50; font-weight: bold; background-color: white;
    padding: 10px 15px; border: 2px solid #add8e6; border-radius: 8px; }
.answers label { display: block; margin-bottom: 12px; padding: 10px 14px; border-radius: 6px; cursor: pointer;
    color: #2c3e50; font-weight: bold; transition: background 0.2s, transform 0.1s; }
.answers input[type="radio"] { margin-right: 10px; accent-color: #007bff; transform: scale(1.2); }
.answers label:nth-child(1) { background: #d6eaff; }
.answers label:nth-child(2) { background: #d6ffd9; }
.answers label:nth-child(3) { background: #fffbd6; }
.answers label:nth-child(4) { background: #ffd6e7; }
.answers label:hover { filter: brightness(0.9); transform: scale(1.02); }
button { background-color: #007bff; color: white; border: none; padding: 10px 20px; font-size: 16px;
    cursor: pointer; border-radius: 5px; margin-top: 10px; }
button:hover { background-color: #0056b3; }
.popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 25px 35px;
    border-radius: 12px; text-align: center; z-index: 2000; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    font-size: 18px; font-weight: bold; animation: pop 0.3s ease-out; max-width: 90%; }
.popup-warning { background: #fff3cd; border: 2px solid #ffecb5; color: #856404; }
.popup-success { background: #d4edda; border: 2px solid #c3e6cb; color: #155724; }
.popup-gold { background: #fff8e1; border: 2px solid #ffeb3b; color: #8d6e00; }
.nilai-besar { font-size: 48px; font-weight: bold; display: block; margin: 10px 0; }
.nilai-merah { color: #e74c3c; } .nilai-kuning { color: #f39c12; }
.nilai-hijau { color: #27ae60; } .nilai-emas { color: #d4af37; }
.peringkat-merah { color: #e74c3c; } .peringkat-kuning { color: #f39c12; }
.peringkat-hijau { color: #27ae60; } .peringkat-emas { color: #d4af37; }
@keyframes pop { 0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
100% { transform: translate(-50%, -50%) scale(1); opacity: 1; } }
.form-identitas { background: white; border: 2px solid #add8e6; border-radius: 10px;
    padding: 20px; max-width: 400px; width: 100%; }
.form-identitas label { display: block; margin-bottom: 8px; font-weight: bold; color: #2c3e50; }
.form-identitas input { width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 6px; }
</style>
</head>
<body>
<div class="container">
    <div class="nav">
        <a href="üïµPetualangan-Seru.html">‚óÄÔ∏è kembali</a>
        <a href="Soal_Petualangan2.pdf" download>üì• Download</a>
    </div>
    <h1 style="color: #2c3e50; text-align: center; background-color: white; padding: 10px 20px; border-radius: 10px; border: 2px solid #add8e6;">
        üïµÔ∏è Detektif Cilik Ayo Uji Kepintaranmu
    </h1>

    <!-- Form Identitas -->
    <div id="formIdentitas" class="form-identitas">
        <label>Nama:</label>
        <input type="text" id="nama" required oninput="mainkanSuaraKetik()">
        <label>Kelas:</label>
        <input type="text" id="kelas" required oninput="mainkanSuaraKetik()">
        <label>No Absen:</label>
        <input type="number" id="absen" required oninput="mainkanSuaraKetik()">
        <button onclick="mulaiKuis()">Mulai Kuis</button>
    </div>

    <!-- Kuis -->
    <div id="quiz" style="display:none;"></div>
</div>

<!-- Suara -->
<audio id="suaraKetik" src="../../suara/typing.mp3"></audio>
<audio id="suaraKlik" src="../../suara/mouse-clicks.mp3"></audio>
<audio id="suaraMulaiNext" src="../../suara/swoosh.mp3"></audio>
<audio id="suaraUlangi" src="../../suara/ulangi.mp3"></audio>

<script>
let soal = [
   { q: "Contoh penggunaan kata tanya apa adalah ‚Ä¶", 
      a: ["Apa warna baju Heri?", "Apa nama saudara Heri?", "Apa dan Heri menangis?", "Apa Heri tinggal?"], k: 0 },
   { q: "Contoh pertanyaan dengan kata di mana adalah ‚Ä¶", 
      a: ["Di mana Heri dan Hani belajar?", "Di mana dengan teman Heri?", "Di mana karena tugas mereka?", "Di mana dengan mereka bertengkar?"], k: 0 },
   { q: "Kata tanya bagaimana digunakan untuk menanyakan ‚Ä¶", 
      a: ["Waktu", "Alasan", "Proses atau cara", "Tempat"], k: 2 },
   { q: "Setelah membaca teks, kamu dapat mengupas informasi dengan bantuan ‚Ä¶", 
      a: ["Kamus", "Kata kerja", "Kata tanya adiksimba", "Kalimat ajakan"], k: 2 },
   { q: "Pernyataan yang benar tentang ide pokok adalah ‚Ä¶", 
      a: ["Ide pokok hanya terdapat di akhir paragraf", "Ide pokok tidak penting", "Ide pokok bisa digunakan untuk mengembangkan paragraf", "Ide pokok selalu berupa nama tokoh"], k: 2 }
];

let indeks = 0;
let benar = 0;
let dataSiswa = {};

function mulaiKuis() {
    const nama = document.getElementById("nama").value.trim();
    const kelas = document.getElementById("kelas").value.trim();
    const absen = document.getElementById("absen").value.trim();

    if (!nama || !kelas || !absen) {
        tampilkanPopup("‚ö†Ô∏è Isi dulu identitasmu ya biar detektif cilik makin keren!", "popup-warning");
        return;
    }

    mainkanSuaraMulaiNext();
    dataSiswa = { nama, kelas, absen };
    document.getElementById("formIdentitas").style.display = "none";
    document.getElementById("quiz").style.display = "block";

    acakArray(soal);
    soal.forEach(s => acakJawabanSoal(s));
    tampilkanSoal();
}

function acakArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
}
function acakJawabanSoal(s) {
    let gabung = s.a.map((teks, i) => ({ teks, benar: i === s.k }));
    for (let i = gabung.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [gabung[i], gabung[j]] = [gabung[j], gabung[i]];
    }
    s.a = gabung.map(o => o.teks);
    s.k = gabung.findIndex(o => o.benar);
}

function tampilkanSoal() {
    const quiz = document.getElementById("quiz");
    if (indeks >= soal.length) {
        const nilai = Math.round((benar / soal.length) * 100);

        // kirim ke Google Form
        const formURL = "https://docs.google.com/forms/u/0/d/e/1FAIpQLSfxHzqPxlfNK-1Ncz03OQiNNncxE9WQsan1KyTF9AgiXHfpyQ/formResponse";
        const params = new URLSearchParams();
        params.append("entry.1114641071", dataSiswa.nama);
        params.append("entry.687539915", dataSiswa.kelas);
        params.append("entry.1445858210", dataSiswa.absen);
        params.append("entry.175130881", nilai);

        fetch(formURL, { method: "POST", body: params, mode: "no-cors" });

        // popup hasil
        let peringkat = "";
        let kelasPopup = "popup-success";
        let warnaNilai = "nilai-merah";
        let warnaPeringkat = "peringkat-merah";

        if (nilai === 100) {
            peringkat = "üèÜ Luar biasa! Kamu benar semua, Sang Juara!";
            kelasPopup = "popup-gold";
            warnaNilai = "nilai-emas";
            warnaPeringkat = "peringkat-emas";
        } else if (nilai >= 80) {
            peringkat = "ü•à Hebat! Hanya sedikit lagi menuju sempurna!";
            warnaNilai = "nilai-hijau";
            warnaPeringkat = "peringkat-hijau";
        } else if (nilai >= 60) {
            peringkat = "ü•â Lumayan! Tingkatkan lagi biar makin mantap!";
            warnaNilai = "nilai-kuning";
            warnaPeringkat = "peringkat-kuning";
        } else {
            peringkat = "üí° Jangan menyerah, ayo coba lagi!";
        }

        tampilkanPopupHasil(`
            üéâ Selesai!<br>
            Benar: ${benar} / ${soal.length}<br>
            Nilai: <span class="nilai-besar ${warnaNilai}">${nilai}%</span>
            <span class="${warnaPeringkat}">${peringkat}</span>
        `, kelasPopup);
        return;
    }
    const s = soal[indeks];
    quiz.innerHTML = `
    <div class="kotak-soal">${s.q}</div>
    <div class="answers">
        ${s.a.map((j, i) => `
            <label>
                <input type="radio" name="jawaban" value="${i}" onclick="mainkanSuaraKlik()" /> 
                ${j}
            </label>`).join('')}
    </div>
    <button onclick="periksaJawaban()">Next</button>
    `;
}

function periksaJawaban() {
    const jawaban = document.querySelector('input[name="jawaban"]:checked');
    if (!jawaban) {
        tampilkanPopup("üéØ Ayo pilih dulu jawabannya, semangat!", "popup-warning");
        return;
    }
    if (parseInt(jawaban.value) === soal[indeks].k) benar++;
    indeks++;
    mainkanSuaraMulaiNext();
    tampilkanSoal();
}

function tampilkanPopup(teks, kelas = "popup-warning") {
    const popup = document.createElement("div");
    popup.className = `popup ${kelas}`;
    popup.innerHTML = teks;
    document.body.appendChild(popup);
    setTimeout(() => popup.remove(), 3000);
}

function tampilkanPopupHasil(teks, kelas) {
    const popup = document.createElement("div");
    popup.className = `popup ${kelas}`;
    popup.innerHTML = `${teks}
        <br><br>
        <button onclick="muatUlang()">üîÑ Mulai Lagi</button>
        <button onclick="keluarKuis()">‚ùå Selesai</button>`;
    document.body.appendChild(popup);
}

function muatUlang() {
    document.querySelectorAll('.popup').forEach(p => p.remove());
    indeks = 0;
    benar = 0;
    mainkanSuaraUlangi();
    document.getElementById("formIdentitas").style.display = "block";
    document.getElementById("quiz").style.display = "none";
}

function keluarKuis() {
    window.location.href = "üïµPetualangan-Seru.html";
}

function mainkanSuaraKlik() {
    const suara = document.getElementById("suaraKlik");
    suara.currentTime = 0; suara.play();
}
function mainkanSuaraKetik() {
    const suara = document.getElementById("suaraKetik");
    suara.currentTime = 0; suara.play();
}
function mainkanSuaraMulaiNext() {
    const suara = document.getElementById("suaraMulaiNext");
    suara.currentTime = 0; suara.play();
}
function mainkanSuaraUlangi() {
    const suara = document.getElementById("suaraUlangi");
    suara.currentTime = 0; suara.play();
}
</script>
</body>
</html>
